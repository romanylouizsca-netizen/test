# نظام التقييم الروحي

تطبيق ويب مصمم لمساعدة العائلات على متابعة وتقييم التزامهم بالبنود الروحية، مع نظام لحساب غرامات التقصير. يوفر التطبيق واجهة خاصة للمدراء لإدارة العائلات، المستخدمين، بنود التقييم، وتحديد مدة التقييم، بالإضافة إلى واجهة مبسطة للمستخدمين لإدخال تقييماتهم اليومية.

---

## ✨ الميزات الرئيسية

-   **نظام أدوار وصلاحيات:** أدوار مختلفة (مدير النظام، مستخدم عادي) مع واجهات مخصصة.
-   **إدارة كاملة للبيانات:** لوحة تحكم للمدير لإضافة وتعديل وحذف العائلات، المستخدمين، وبنود التقييم.
-   **تقييم يومي:** يمكن للمستخدمين تسجيل تقييمهم اليومي بسهولة لمختلف البنود.
-   **حساب تلقائي للغرامات:** يقوم النظام بحساب غرامة التقصير لكل مستخدم ولكل عائلة بناءً على البيانات المدخلة.
-   **تقارير مفصلة:** يمكن للمدراء عرض تقارير شاملة لكل عائلة وتصديرها كملف PDF.
-   **واجهة مستخدم عصرية:** تصميم جذاب وسهل الاستخدام باللغة العربية.
-   **تحديثات لحظية:** يعتمد على Firebase Firestore لتوفير مزامنة فورية للبيانات.

---

## 🛠️ التقنيات المستخدمة

-   **React:** مكتبة JavaScript لبناء واجهات المستخدم.
-   **TypeScript:** لإضافة أنواع ثابتة إلى JavaScript.
-   **Vite:** أدوات بناء سريعة لواجهة الويب الحديثة.
-   **Tailwind CSS:** إطار عمل CSS لتصميم سريع ومخصص.
-   **Firebase:** منصة متكاملة تشمل:
    -   **Firestore:** قاعدة بيانات NoSQL سحابية.
    -   **Authentication:** لإدارة تسجيل دخول المستخدمين.
-   **React Router:** للتنقل بين الصفحات في التطبيق.
-   **html2canvas & jsPDF:** لتصدير التقارير إلى ملفات PDF.

---

## 🚀 كيفية الإعداد والتشغيل

اتبع الخطوات التالية لإعداد المشروع وتشغيله على جهازك المحلي.

### المتطلبات المسبقة

-   [Node.js](https://nodejs.org/) (إصدار 18 أو أحدث).
-   مدير حزم `npm` أو `yarn`.
-   حساب [Firebase](https://firebase.google.com/).

### 1. إعداد مشروع Firebase

1.  اذهب إلى [وحدة تحكم Firebase](https://console.firebase.google.com/).
2.  أنشئ مشروعًا جديدًا.
3.  من لوحة التحكم، أضف تطبيق ويب جديد (Web App).
4.  انسخ كائن إعدادات Firebase (firebaseConfig)، ستحتاجه في الخطوة التالية.
5.  في قسم **Authentication**، قم بتفعيل **Email/Password** كوسيلة لتسجيل الدخول.
6.  في قسم **Firestore Database**، أنشئ قاعدة بيانات جديدة وابدأ في وضع الاختبار (Test mode) للتجربة الأولية، أو قم بضبط قواعد الأمان (Security Rules) حسب الحاجة.

### 2. إعداد المشروع المحلي

1.  **استنسخ المستودع:**
    ```bash
    git clone https://github.com/7esoo/spiritual-evaluation-system.git
    cd spiritual-evaluation-system
    ```

2.  **تثبيت الاعتماديات:**
    ```bash
    npm install
    ```

3.  **إعداد متغيرات البيئة:**
    -   أنشئ ملفًا جديدًا باسم `.env.local` في جذر المشروع.
    -   انسخ محتوى ملف `.env.example` والصقه في ملف `.env.local`.
    -   املأ المتغيرات بقيم إعدادات Firebase التي نسختها سابقًا.

    ```ini
    # .env.local

    VITE_FIREBASE_API_KEY="YOUR_API_KEY"
    VITE_FIREBASE_AUTH_DOMAIN="YOUR_PROJECT_ID.firebaseapp.com"
    VITE_FIREBASE_PROJECT_ID="YOUR_PROJECT_ID"
    VITE_FIREBASE_STORAGE_BUCKET="YOUR_PROJECT_ID.appspot.com"
    VITE_FIREBASE_MESSAGING_SENDER_ID="YOUR_MESSAGING_SENDER_ID"
    VITE_FIREBASE_APP_ID="YOUR_APP_ID"
    ```

### 3. إنشاء المستخدم المدير الأول

لكي تتمكن من الدخول إلى لوحة تحكم المدير، يجب إنشاء حساب المدير يدويًا:

1.  **في Firebase Authentication:**
    -   اذهب إلى قسم **Authentication** -> **Users**.
    -   اضغط على **Add user** وأنشئ مستخدمًا جديدًا ببريد إلكتروني وكلمة مرور.
    -   انسخ **User UID** الخاص به بعد إنشائه.

2.  **في قاعدة بيانات Firestore:**
    -   اذهب إلى قسم **Firestore Database**.
    -   أنشئ Collection جديد باسم `users`.
    -   أضف Document جديد (يمكنك اختيار Auto-ID).
    -   أضف الحقول التالية للمستخدم المدير:
        -   `uid` (string): الصق الـ UID الذي نسخته.
        -   `fullName` (string): اسم المدير (مثال: "مدير النظام").
        -   `email` (string): نفس البريد الإلكتروني الذي استخدمته في Authentication.
        -   `familyId` (string): اتركه فارغًا أو أي قيمة مؤقتة.
        -   `role` (string): اكتب `مدير النظام`.
        -   `status` (string): اكتب `مفعل`.

### 4. تشغيل التطبيق محلياً

الآن يمكنك تشغيل خادم التطوير المحلي:

```bash
npm run dev
```

افتح المتصفح على العنوان `http://localhost:5173` (أو العنوان الذي يظهر في الطرفية) وادخل باستخدام بيانات حساب المدير.

---
## 🚀 النشر على GitHub Pages

لنشر التطبيق وجعله متاحًا عبر الإنترنت باستخدام GitHub Pages، اتبع الخطوات التالية:

1.  **تأكد من إعداد المستودع:**
    يجب أن يكون مشروعك مربوطًا بمستودع على GitHub.

2.  **تفعيل GitHub Pages:**
    -   اذهب إلى مستودع المشروع على GitHub.
    -   انتقل إلى `Settings` -> `Pages`.
    -   تحت قسم `Build and deployment`، اختر المصدر (`Source`) ليكون `Deploy from a branch`.
    -   اختر الفرع (`Branch`) ليكون `gh-pages` والمجلد `/(root)`.
    -   اضغط `Save`. (قد لا يكون فرع `gh-pages` موجودًا بعد، سيتم إنشاؤه تلقائيًا في الخطوة التالية).

3.  **تشغيل أمر النشر:**
    في كل مرة تريد فيها نشر تحديثاتك، كل ما عليك فعله هو تشغيل الأمر التالي في الطرفية من مجلد مشروعك:
    ```bash
    npm run deploy
    ```
    هذا الأمر سيقوم بالآتي:
    -   `predeploy`: يقوم ببناء (`build`) نسخة الإنتاج من مشروعك في مجلد `dist`.
    -   `deploy`: يقوم بأخذ محتويات مجلد `dist` ورفعها إلى فرع `gh-pages` في مستودعك على GitHub.

4.  **الوصول إلى موقعك:**
    بعد بضع دقائق، سيصبح موقعك متاحًا على الرابط الموجود في خاصية `homepage` في ملف `package.json`.
    (مثال: `https://7esoo.github.io/spiritual-evaluation-system/`)

---

## 🏗️ هيكل المشروع

```
spiritual-evaluation-system/
├── public/
├── src/
│   ├── components/      # مكونات واجهة المستخدم القابلة لإعادة الاستخدام
│   ├── context/         # سياق React لإدارة الحالة العامة (AppContext)
│   ├── firebase/        # إعدادات الاتصال بـ Firebase
│   ├── hooks/           # خطافات مخصصة (Custom Hooks)
│   ├── screens/         # صفحات التطبيق الرئيسية
│   ├── App.tsx          # المكون الرئيسي للتطبيق ونظام التوجيه (Routing)
│   ├── index.tsx        # نقطة دخول التطبيق
│   └── types.ts         # تعريفات TypeScript للأنواع والواجهات
├── .env.example         # مثال لملف متغيرات البيئة
├── index.html           # ملف HTML الرئيسي
├── package.json         # الاعتماديات والسكربتات
└── README.md            # هذا الملف
```
